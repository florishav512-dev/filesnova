import{r as d,j as e}from"./index-DZ9cnodX.js";import{J as H}from"./jszip.min-Ba5cqwo-.js";import{U as ie}from"./UploadZone-CFBEcuA8.js";import{T as ce}from"./ToolSeo-DS89rTID.js";import{T as de,S as me}from"./toolSeoData-n72o8jEH.js";import{T as he}from"./ToolsMenu-By04owrg.js";import{a as xe}from"./FILESNOVANEWICON-Y5q8zanr.js";import{c as ue}from"./createLucideIcon-62jdrpjy.js";import{S as pe}from"./shield-BIhTG5PH.js";import{Z as ge}from"./zap-n8RHxRDu.js";import{D as fe}from"./download-COwvIohT.js";import"./jszip.min-BEOm39Cw.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./upload-CUxp5Sv7.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],we=ue("table",be),ve={delimiter:"comma",customDelimiter:"",includeHeader:!0,trimCells:!0,quoteAll:!1,preserveTrailingEmpty:!0},Me=()=>{const[p,J]=d.useState(null),[L,M]=d.useState(null),[I,P]=d.useState(null),[h,B]=d.useState([]),[j,X]=d.useState(""),[Z,A]=d.useState(!1),[Q,y]=d.useState(0),[O,N]=d.useState(null),[R,S]=d.useState(null),[o,k]=d.useState(ve),{title:W,description:G,canonical:K,breadcrumb:Y}=de["/tools/xlsx-to-csv"],U=d.useMemo(()=>o.delimiter==="comma"?",":o.delimiter==="semicolon"?";":o.delimiter==="tab"?"	":o.customDelimiter||",",[o]),$=t=>{const s=t.replace(/\d/g,"");let r=0;for(let l=0;l<s.length;l++)r=r*26+(s.charCodeAt(l)-64);return r-1},ee=async t=>{const s=[],r=t.files["xl/sharedStrings.xml"];if(!r)return s;const l=await r.async("string"),c=new DOMParser().parseFromString(l,"application/xml"),b=Array.from(c.getElementsByTagName("si"));for(const C of b){const g=C.getElementsByTagName("t");if(g&&g.length>0){let m="";for(const a of Array.from(g))m+=a.textContent||"";s.push(m)}else s.push("")}return s},te=async t=>{const s=t.files["xl/workbook.xml"];if(!s)throw new Error("Invalid XLSX: missing xl/workbook.xml");const r=t.files["xl/_rels/workbook.xml.rels"];if(!r)throw new Error("Invalid XLSX: missing xl/_rels/workbook.xml.rels");const l=await s.async("string"),i=await r.async("string"),c=new DOMParser,b=c.parseFromString(l,"application/xml"),C=c.parseFromString(i,"application/xml"),g=new Map;Array.from(C.getElementsByTagName("Relationship")).forEach(a=>{const x=a.getAttribute("Id")||"",w=a.getAttribute("Target")||"";x&&w&&g.set(x,w)});const m=[];Array.from(b.getElementsByTagName("sheet")).forEach(a=>{const x=a.getAttribute("name")||"Sheet",w=a.getAttribute("r:id")||"";m.push({name:x,relId:w,path:void 0})});for(const a of m){const x=g.get(a.relId||"");x&&(a.path=`xl/${x.replace(/^\//,"")}`)}return m},V=async(t,s,r,l,i)=>{const c=t.files[s];if(!c)throw new Error(`Worksheet not found: ${s}`);const b=await c.async("string"),g=new DOMParser().parseFromString(b,"application/xml"),m=Array.from(g.getElementsByTagName("row")),a=[],x=m.length||1,w=u=>{let f=i.trimCells?u.trim():u;return i.quoteAll||/["\r\n]/.test(f)||f.includes(l)?(f=f.replace(/"/g,'""'),`"${f}"`):f};let z=!1,F=0;for(let u=0;u<m.length;u++){const f=m[u],q=Array.from(f.getElementsByTagName("c")),_=[];let E=-1;q.forEach(n=>{const v=n.getAttribute("r")||"",T=$(v);T>E&&(E=T)}),F=Math.max(F,E+1);for(let n=0;n<=E;n++)_[n]="";q.forEach(n=>{const v=n.getAttribute("r")||"",T=$(v),oe=n.getAttribute("t");let D=n.getElementsByTagName("v")[0]?.textContent||"";if(oe==="s"){const ne=parseInt(D,10);D=r[ne]??""}_[T]=D});const ae=i.preserveTrailingEmpty?_:se(_);if(a.push(ae.map(w).join(l)),y(Math.round((u+1)/x*100)),await new Promise(n=>setTimeout(n,0)),!z&&i.includeHeader&&a.length===1){const n=[];for(let v=0;v<F;v++)n.push(re(v));a.unshift(n.map(w).join(l)),z=!0}}return m.length===0&&i.includeHeader&&a.push(["A"].map(u=>`"${u}"`).join(l)),a.join(`
`)},se=t=>{let s=t.length-1;for(;s>=0&&(t[s]??"")==="";)s--;return t.slice(0,s+1)},re=t=>{let s=t+1,r="";for(;s>0;){const l=(s-1)%26;r=String.fromCharCode(65+l)+r,s=Math.floor((s-1)/26)}return r};d.useEffect(()=>{let t=!1;return(async()=>{if(!p){M(null),P(null),B([]),X(""),N(null),S(null);return}try{A(!0),y(5),S(null),N(null);const s=await H.loadAsync(await p.arrayBuffer());if(t)return;M(s);const r=await ee(s);if(t)return;P(r);const l=await te(s);if(t)return;const i=l.map(c=>({...c,path:c.path||"xl/worksheets/sheet1.xml"}));B(i),X(i[0]?.relId||""),y(15)}catch(s){console.error(s),t||S(s?.message||"Failed to read XLSX.")}finally{t||A(!1)}})(),()=>{t=!0}},[p]);const le=async()=>{if(!(!p||!L||!I||h.length===0)){A(!0),y(20),S(null),N(null);try{if(j==="__ALL__"){const t=new H;for(let r=0;r<h.length;r++){const l=h[r],i=l.path,c=await V(L,i,I,U,o),b=l.name.replace(/[\\/:*?"<>|]/g,"_");t.file(`${b||`Sheet${r+1}`}.csv`,c),y(Math.round(20+(r+1)/h.length*75)),await new Promise(C=>setTimeout(C,0))}const s=await t.generateAsync({type:"blob"});N(URL.createObjectURL(s))}else{const t=h.find(l=>l.relId===j)||h[0],s=await V(L,t.path,I,U,o),r=new Blob([s],{type:"text/csv"});N(URL.createObjectURL(r))}y(100)}catch(t){console.error(t),S(t?.message||"Failed to convert file.")}finally{A(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:W,description:G,canonical:K,breadcrumb:Y,showBreadcrumb:!0}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 relative overflow-hidden pt-24",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/20 to-purple-600/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-orange-600/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-br from-green-400/10 to-blue-600/10 rounded-full blur-3xl animate-pulse delay-500"})]}),e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl shadow-lg border-b border-white/20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center h-20 gap-",children:[e.jsx("div",{className:"relative shrink-0",children:e.jsx("img",{src:xe,alt:"Files Nova",className:"w-16 h-16 md:w-20 md:h-20 object-contain",draggable:!1,loading:"lazy",width:"96",height:"96"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Files Nova"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"XLSX to CSV"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(he,{})})]})})}),e.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto px-4 py-10",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-blue-50 to-indigo-100 rounded-3xl p-8 mb-8 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/40 backdrop-blur-sm"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-700 rounded-2xl flex items-center justify-center mb-6 shadow-xl",children:e.jsx(we,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 mb-2",children:"XLSX to CSV"}),e.jsx("p",{className:"text-gray-700 text-lg leading-relaxed",children:"Choose the sheet, delimiter, and export as a single CSV or a ZIP with all sheets â€” fast and private in your browser."}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(pe,{className:"w-4 h-4 mr-2 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"100% Secure"})]}),e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(ge,{className:"w-4 h-4 mr-2 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Lightning Fast"})]}),e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(me,{className:"w-4 h-4 mr-2 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Premium Quality"})]})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"1. Upload XLSX File"}),e.jsx(ie,{accept:".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",multiple:!1,title:"Drop your XLSX file here",buttonLabel:"Choose File",supportedFormats:"XLSX",onFilesSelected:t=>{const s=t[0]||null;J(s),N(null),S(null)}}),p&&h.length>0&&e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 rounded-xl border border-gray-200 bg-white/70",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Sheet"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("select",{value:j,onChange:t=>X(t.target.value),className:"p-2 border border-gray-300 rounded-lg bg-white",children:[h.map(t=>e.jsx("option",{value:t.relId,children:t.name||"Sheet"},t.relId)),e.jsx("option",{value:"__ALL__",children:"All sheets (ZIP)"})]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Export a single sheet as CSV, or choose ",e.jsx("em",{children:"All sheets"})," to download a ZIP of CSVs."]})]})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-gray-200 bg-white/70",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"CSV Format"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Delimiter"}),e.jsxs("select",{value:o.delimiter,onChange:t=>k(s=>({...s,delimiter:t.target.value})),className:"p-2 border border-gray-300 rounded-lg bg-white w-full",children:[e.jsx("option",{value:"comma",children:"Comma (,)"}),e.jsx("option",{value:"semicolon",children:"Semicolon (;)"}),e.jsx("option",{value:"tab",children:"Tab (\\t)"}),e.jsx("option",{value:"custom",children:"Customâ€¦"})]}),o.delimiter==="custom"&&e.jsx("input",{value:o.customDelimiter,onChange:t=>k(s=>({...s,customDelimiter:t.target.value})),placeholder:"Enter delimiter",className:"mt-2 w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.includeHeader,onChange:t=>k(s=>({...s,includeHeader:t.target.checked}))}),e.jsx("span",{className:"text-sm text-gray-700",children:"Include header (A, B, Câ€¦)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.quoteAll,onChange:t=>k(s=>({...s,quoteAll:t.target.checked}))}),e.jsx("span",{className:"text-sm text-gray-700",children:"Quote all values"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.trimCells,onChange:t=>k(s=>({...s,trimCells:t.target.checked}))}),e.jsx("span",{className:"text-sm text-gray-700",children:"Trim cell values"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.preserveTrailingEmpty,onChange:t=>k(s=>({...s,preserveTrailingEmpty:t.target.checked}))}),e.jsx("span",{className:"text-sm text-gray-700",children:"Preserve trailing empty cells"})]})]})]})]})]}),e.jsxs("button",{onClick:le,disabled:!p||h.length===0||Z,className:"mt-6 w-full px-4 py-4 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white font-bold rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:["Convert to ",j==="__ALL__"?"ZIP":"CSV"]}),Z&&e.jsx("div",{className:"mt-4 w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full transition-all",style:{width:`${Q}%`}})}),R&&e.jsx("p",{className:"text-red-600 mt-4",children:R})]}),O&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8 text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"2. Download"}),e.jsxs("a",{href:O,download:j==="__ALL__"?p?.name.replace(/\.xlsx$/i,"_sheets.zip")||"sheets.zip":p?.name.replace(/\.xlsx$/i,".csv")||"sheet.csv",className:"inline-flex items-center justify-center w-full px-4 py-4 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition-all",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"}),"Download ",j==="__ALL__"?"ZIP":"CSV"]})]})]})]})]})};export{Me as default};
