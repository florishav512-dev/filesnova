import{r as o,j as e,H as me}from"./index-BqODA4Z-.js";import{J as Y}from"./JsonLd-CQ6VSy7z.js";import{U as pe}from"./UploadZone-Dcn5bgy0.js";import{A as xe}from"./AdSpace-CBspNFZz.js";import{J as he}from"./jszip.min-Dt1rHn3T.js";import{P as ue,S as ee,r as z}from"./PDFButton-DVuRzP7v.js";import{T as ge}from"./ToolSeo-DcR00B-d.js";import{T as fe,S as te}from"./toolSeoData-D4OxtDbz.js";import{T as be}from"./ToolsMenu-DgmoAlHJ.js";import{c as ae,S as we}from"./sparkles-p176mTZJ.js";import{S as je,Z as ye}from"./zap-BBhO4qyC.js";import{F as ve}from"./type-CH83knKH.js";import{M as Ne,a as Se}from"./move-up-right-Cg9Iv5rK.js";import{D as Pe}from"./download-QCpQvKoL.js";import"react-router-dom";import"./upload-CkfWjy5u.js";import"./jszip.min-BomeYN2x.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-BtmEAsOv.js";import"./image-B4Dc5wH4.js";const ke=ae("BookOpenCheck",[["path",{d:"M8 3H2v15h7c1.7 0 3 1.3 3 3V7c0-2.2-1.8-4-4-4Z",key:"1i8u0n"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V3h-6c-2.2 0-4 1.8-4 4v14c0-1.7 1.3-3 3-3h7v-2.3",key:"jb5l51"}]]),se=ae("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]),Te={A4:{w:595,h:842},Letter:{w:612,h:792}},Fe=i=>i==="compact"?36:i==="wide"?72:54,ze=i=>{const d=i.replace("#",""),r=d.length===3?d.split("").map(n=>n+n).join(""):d,x=parseInt(r,16),c=x>>16&255,a=x>>8&255,l=x&255;return{r:c,g:a,b:l}};async function Ce(i){const d=await he.loadAsync(i),r=Object.keys(d.files).filter(a=>/ppt\/slides\/slide\d+\.xml$/.test(a)).sort((a,l)=>{const n=parseInt(a.match(/slide(\d+)\.xml/)?.[1]||"0",10),f=parseInt(l.match(/slide(\d+)\.xml/)?.[1]||"0",10);return n-f}),x=Object.keys(d.files).filter(a=>/ppt\/notesSlides\/notesSlide\d+\.xml$/.test(a)).reduce((a,l)=>{const n=parseInt(l.match(/notesSlide(\d+)\.xml/)?.[1]||"0",10);return a[n]=l,a},{}),c=[];for(const a of r){const l=parseInt(a.match(/slide(\d+)\.xml/)?.[1]||"0",10),n=await d.files[a].async("string"),f=new DOMParser,P=f.parseFromString(n,"application/xml"),w=Array.from(P.getElementsByTagName("a:t")).map(h=>h.textContent||"");let m;try{const h=Array.from(P.getElementsByTagName("p:ph")).find(j=>j.getAttribute("type")==="title");if(h){const j=h.parentElement?.parentElement,v=j?Array.from(j.getElementsByTagName("a:t")):[];v.length&&(m=v.map(A=>A.textContent||"").join(" ").trim())}}catch{}!m&&w.length&&(m=w[0].trim());const O=w.join(`
`).trim();let k;const C=x[l];if(C){const h=await d.files[C].async("string"),j=f.parseFromString(h,"application/xml");k=Array.from(j.getElementsByTagName("a:t")).map(F=>F.textContent||"").join(`
`).trim()||void 0}c.push({index:l,title:m,body:O,notes:k})}return c.sort((a,l)=>a.index-l.index),c}const qe=()=>{const[i,d]=o.useState(null),[r,x]=o.useState([]),[c,a]=o.useState(!1),[l,n]=o.useState(0),[f,P]=o.useState(null),[R,w]=o.useState(null),[m,O]=o.useState("A4"),[k,C]=o.useState("portrait"),[h,j]=o.useState("normal"),[v,A]=o.useState("#ffffff"),[F,W]=o.useState(!0),[E,Z]=o.useState(!0),[I,K]=o.useState(!1),[L,V]=o.useState(!0);o.useEffect(()=>{try{const t=localStorage.getItem("fn_pptx2pdf_settings");if(!t)return;const s=JSON.parse(t);s.pageSizeKey&&O(s.pageSizeKey),s.orientation&&C(s.orientation),s.marginPreset&&j(s.marginPreset),typeof s.pageBg=="string"&&A(s.pageBg),typeof s.includeSlideNumbers=="boolean"&&W(s.includeSlideNumbers),typeof s.emphasizeTitles=="boolean"&&Z(s.emphasizeTitles),typeof s.includeNotes=="boolean"&&K(s.includeNotes),typeof s.createOutline=="boolean"&&V(s.createOutline)}catch{}},[]),o.useEffect(()=>{try{localStorage.setItem("fn_pptx2pdf_settings",JSON.stringify({pageSizeKey:m,orientation:k,marginPreset:h,pageBg:v,includeSlideNumbers:F,emphasizeTitles:E,includeNotes:I,createOutline:L}))}catch{}},[m,k,h,v,F,E,I,L]),o.useRef(null);const le=t=>{const s=t[0]||null;d(s),x([]),P(null),w(null)},G=(t,s)=>{x(T=>{const y=s==="up"?t-1:t+1;if(y<0||y>=T.length)return T;const N=[...T];return[N[t],N[y]]=[N[y],N[t]],N})},oe=async()=>{if(i){a(!0),n(0),w(null);try{const t=await i.arrayBuffer(),s=await Ce(t);x(s)}catch(t){console.error(t),w(t?.message||"Failed to read PPTX.")}finally{a(!1)}}},ne=async()=>{if(r.length){a(!0),n(0),w(null),P(null);try{const t=await ue.create(),s=await t.embedFont(ee.Helvetica),T=await t.embedFont(ee.HelveticaBold),y=m==="Auto"?{w:842,h:595}:Te[m],N=m==="Auto"?y:k==="landscape"?{w:y.h,h:y.w}:y,re=N.w,ie=N.h,u=Fe(h),X=ze(v),Q=[];for(let g=0;g<r.length;g++){const B=r[g],S=t.addPage([re,ie]),{width:$,height:U}=S.getSize();S.drawRectangle({x:0,y:0,width:$,height:U,color:z(X.r/255,X.g/255,X.b/255)});let p=U-u;const H=$-u*2,Ae=16;if(F){const b=`Slide ${g+1}`,M=s.widthOfTextAtSize(b,10);S.drawText(b,{x:$-u-M,y:U-u+2,size:10,font:s,color:z(.2,.2,.2)})}const _=(B.title||"").trim();_&&E&&(J(_,T,18,H).forEach(D=>{p-=22,S.drawText(D,{x:u,y:p,size:18,font:T,color:z(.05,.05,.05)})}),p-=8);const q=(B.body||"").trim();if(q&&J(q,s,12,H).forEach(D=>{if(p-=14,p<u){S.drawText("…",{x:u,y:p,size:12,font:s});return}S.drawText(D,{x:u,y:p,size:12,font:s,color:z(0,0,0)})}),I&&B.notes){p-=14,S.drawText("Notes:",{x:u,y:p,size:12,font:T,color:z(.15,.15,.15)});const b=11;J(B.notes,s,b,H).forEach(D=>{p-=b+2,!(p<u)&&S.drawText(D,{x:u,y:p,size:b,font:s,color:z(.12,.12,.12)})})}L&&Q.push({title:_||`Slide ${g+1}`,pageIndex:g}),n(Math.round((g+1)/r.length*100)),g%2===1&&await new Promise(b=>setTimeout(b,0))}try{t.setPageLabels&&t.setPageLabels(Q.map(g=>({pageIndex:g.pageIndex,label:g.title})))}catch{}const ce=await t.save(),de=new Blob([ce],{type:"application/pdf"});P(URL.createObjectURL(de))}catch(t){console.error(t),w(t?.message||"Failed to convert file.")}finally{a(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{...fe["/tools/pptx-to-pdf"]}),e.jsxs(me,{children:[e.jsx("title",{children:"PPTX to PDF – Fast & Free Online Converter | FilesNova"}),e.jsx("meta",{name:"description",content:"Convert PPTX slides to PDF in your browser. Advanced options: page size, orientation, margins, titles, notes & outline. Private, fast, free."}),e.jsx("link",{rel:"canonical",href:"https://filesnova.com/tools/pptx-to-pdf"})]}),e.jsx(Y,{data:{"@context":"https://schema.org","@type":"WebApplication",name:"PPTX to PDF – Files Nova",url:"https://filesnova.com/tools/pptx-to-pdf",applicationCategory:"FileConverter",operatingSystem:"Web",offers:{"@type":"Offer",price:"0",priceCurrency:"USD"}}}),e.jsx(Y,{data:{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:"https://filesnova.com/"},{"@type":"ListItem",position:2,name:"PPTX to PDF",item:"https://filesnova.com/tools/pptx-to-pdf"}]}}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 relative overflow-hidden pt-24",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/20 to-purple-600/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-orange-600/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-br from-green-400/10 to-blue-600/10 rounded-full blur-3xl animate-pulse delay-500"})]}),e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl shadow-lg border-b border-white/20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center h-20 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx(we,{className:"w-7 h-7 text-white animate-pulse"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full animate-bounce"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Files Nova"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"PPTX to PDF"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(be,{})})]})})}),e.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto px-4 py-10",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-blue-50 to-indigo-100 rounded-3xl p-8 mb-8 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/40 backdrop-blur-sm"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-700 rounded-2xl flex items-center justify-center mb-6 shadow-xl",children:e.jsx(se,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 mb-2",children:"PPTX to PDF"}),e.jsx("p",{className:"text-gray-700 text-lg leading-relaxed",children:"Convert your slides to clean, readable PDFs — with options for titles, notes, page size, and outline."}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(je,{className:"w-4 h-4 mr-2 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"100% Secure"})]}),e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(ye,{className:"w-4 h-4 mr-2 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Lightning Fast"})]}),e.jsxs("div",{className:"flex items-center bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl shadow-sm",children:[e.jsx(te,{className:"w-4 h-4 mr-2 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Premium Quality"})]})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"1. Upload PPTX File"}),e.jsx(pe,{accept:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",multiple:!1,title:"Drop your PPTX file here",buttonLabel:"Choose File",supportedFormats:"PPTX",onFilesSelected:le}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-2 gap-4 bg-white/60 backdrop-blur-sm border border-white/40 rounded-2xl p-4",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Page Size"}),e.jsxs("select",{value:m,onChange:t=>O(t.target.value),className:"w-full p-2 rounded-lg border border-gray-300 bg-white",children:[e.jsx("option",{value:"A4",children:"A4"}),e.jsx("option",{value:"Letter",children:"Letter"}),e.jsx("option",{value:"Auto",children:"Auto (widescreen)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Orientation"}),e.jsxs("select",{value:k,onChange:t=>C(t.target.value),className:"w-full p-2 rounded-lg border border-gray-300 bg-white",disabled:m==="Auto",children:[e.jsx("option",{value:"portrait",children:"Portrait"}),e.jsx("option",{value:"landscape",children:"Landscape"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Margins"}),e.jsxs("select",{value:h,onChange:t=>j(t.target.value),className:"w-full p-2 rounded-lg border border-gray-300 bg-white",children:[e.jsx("option",{value:"compact",children:"Compact"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"wide",children:"Wide"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Page Background"}),e.jsx("input",{type:"color",value:v,onChange:t=>A(t.target.value),className:"h-10 w-14 border rounded-lg",title:"Shown behind text"})]})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:F,onChange:t=>W(t.target.checked)}),e.jsxs("span",{className:"text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"})," Include slide numbers"]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:t=>Z(t.target.checked)}),e.jsxs("span",{className:"text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"})," Emphasize titles"]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:t=>K(t.target.checked)}),e.jsxs("span",{className:"text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"})," Include speaker notes"]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:t=>V(t.target.checked)}),e.jsxs("span",{className:"text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"})," Add outline/bookmarks"]})]})]})]}),e.jsxs("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:[e.jsx("button",{onClick:oe,disabled:!i||c,className:"w-full px-4 py-3 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white font-bold rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Read Slides"}),e.jsx("button",{onClick:ne,disabled:!r.length||c,className:"w-full px-4 py-3 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition disabled:opacity-50",children:"Convert to PDF"})]}),c&&e.jsx("div",{className:"mt-4 w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full animate-pulse",style:{width:`${l}%`}})}),R&&e.jsx("p",{className:"text-red-600 mt-4",children:R})]}),r.length>0&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:["2. Review & Reorder Slides (",r.length,")"]}),e.jsx("div",{className:"space-y-4",children:r.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900 truncate",children:t.title?.trim()||`Slide ${s+1}`}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:t.body.slice(0,120)||"(no text)"}),t.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1 truncate",children:["Notes: ",t.notes.slice(0,100)]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:()=>G(s,"up"),disabled:s===0,className:"p-2 rounded-lg hover:bg-gray-200 disabled:opacity-40",title:"Move up",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>G(s,"down"),disabled:s===r.length-1,className:"p-2 rounded-lg hover:bg-gray-200 disabled:opacity-40",title:"Move down",children:e.jsx(Se,{className:"w-4 h-4"})})]})]},`${t.index}-${s}`))})]}),f&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 mb-8 text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"3. Download"}),e.jsxs("a",{href:f,download:i?.name.replace(/\.pptx$/i,".pdf")||"presentation.pdf",className:"inline-flex items-center justify-center w-full px-4 py-4 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition-all",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2"})," Download PDF"]})]})]}),e.jsx(xe,{})]})]})};function J(i,d,r,x){const c=[],a=i.split(/\s+/);let l="";for(const n of a){const f=l?`${l} ${n}`:n;d.widthOfTextAtSize(f,r)>x?(l&&c.push(l),l=n):l=f}return l&&c.push(l),c}export{qe as default};
