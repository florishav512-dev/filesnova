import{r as s,j as e}from"./index-B-P-8OYA.js";import{g as D}from"./qpdf-yqFBDzp5.js";import{P as E}from"./PageLayout-BH4WfwWd.js";import{T as q}from"./ToolSeo-DrI2oGCf.js";import{U as S}from"./UploadZone-CmbkFF6-.js";import"./createLucideIcon-LAAGRmDe.js";import"./sparkles-CRXTE-Fz.js";import"./upload-DpPaOGPK.js";const K=()=>{const[n,L]=s.useState(null),[u,o]=s.useState(!1),[f,l]=s.useState(null),p=s.useRef(null),h=s.useRef(null),m=s.useRef(null),x=s.useRef(null),w=s.useRef(null),j=s.useRef(null),y=s.useRef(null),v=r=>{L(r),l(null)},N=async()=>{if(!n){l("Please select a PDF file.");return}o(!0),l(null);try{const r=await D(),R=new Uint8Array(await n.arrayBuffer()),g=p.current?.value||"",a=h.current?.value||"",b=m.current?.value==="256"?"256":"128";if(!g&&!a){l("You must provide at least a user or an owner password."),o(!1);return}const P="input.pdf",k="locked.pdf",d=["--encrypt",g,a,b,`--print=${x.current?.checked?"full":"none"}`,w.current?.checked?"--modify=all":"--modify=none",`--extract=${j.current?.checked?"y":"n"}`,`--annotate=${y.current?.checked?"y":"n"}`];b==="256"&&!a&&d.push("--allow-insecure"),d.push("--",P,k);const t=await r.run(d,{[P]:R});if(!t||typeof t.exitCode!="number"){l("QPDF engine failed to return a result. Make sure the wasm file at /qpdf/qpdf.wasm loads correctly."),o(!1);return}if(t.exitCode!==0){const c=(t.stderr?.split(`
`)||[]).slice(-8).join(`
`);console.error("qpdf stderr:",t.stderr),l(c||"qpdf failed to process the file."),o(!1);return}const F=t.files[k];if(!F){const c=(t.stderr?.split(`
`)||[]).slice(-8).join(`
`);l(c||"qpdf did not produce an output file."),o(!1);return}const A=new Blob([F],{type:"application/pdf"}),i=document.createElement("a");i.href=URL.createObjectURL(A),i.download=`locked_${n.name}`,document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(r){console.error(r),l(r.message||"An error occurred while locking the PDF.")}finally{o(!1)}};return e.jsxs(E,{children:[e.jsx(q,{title:"Lock PDF",description:"Encrypt and protect your PDF files with a password."}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Lock PDF"}),e.jsx("p",{className:"text-lg mt-2",children:"Encrypt and protect your PDF files with a password."})]}),e.jsxs(e.Fragment,{children:[e.jsx(S,{onFileSelect:v,accept:{"application/pdf":[".pdf"]}}),n&&e.jsxs("div",{className:"mt-8 p-6 border rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Encryption Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userPassword",children:"User Password (for opening)"}),e.jsx("input",{type:"password",id:"userPassword",ref:p,className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ownerPassword",children:"Owner Password (for permissions)"}),e.jsx("input",{type:"password",id:"ownerPassword",ref:h,className:"w-full p-2 border rounded"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"keyLength",children:"Key Length"}),e.jsxs("select",{id:"keyLength",ref:m,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"128",children:"128-bit"}),e.jsx("option",{value:"256",children:"256-bit"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Permissions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"allowPrint",ref:x,defaultChecked:!0})," ",e.jsx("label",{htmlFor:"allowPrint",children:"Allow Printing"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"allowModify",ref:w})," ",e.jsx("label",{htmlFor:"allowModify",children:"Allow Modify"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"allowCopy",ref:j})," ",e.jsx("label",{htmlFor:"allowCopy",children:"Allow Copying"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"allowAnnotations",ref:y})," ",e.jsx("label",{htmlFor:"allowAnnotations",children:"Allow Annotations"})]})]})]}),e.jsx("button",{onClick:N,disabled:u||!n,className:"mt-6 w-full bg-blue-600 text-white p-3 rounded-lg disabled:bg-gray-400",children:u?"Locking...":"Lock PDF"}),f&&e.jsx("p",{className:"text-red-500 mt-4",children:f})]})]})]})};export{K as default};
